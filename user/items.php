<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="content-type" content="text/html;charset=utf-8" /><?phprequire '../includes/mySQL_Sessions.inc';require '../includes/ItemFunctions.inc';require '../includes/TableRelated.inc';require '../includes/EditModeGenerator.inc';require '../includes/DirectoryRelated.inc';require '../includes/ThemeGen.inc';require '../includes/javascript/LoadFromDropDown.inc';session_start();	if (empty($_SESSION['idnum']))	{ die("Reload Page."); }$idnum[0] = $_SESSION['idnum'];$idnum[2] = mysqlclean($_GET,'loc',8,$connection);$sess_id = session_id();$key = dechex(mktime());$EditMode = 0;$m = $_GET['m'];if ($idnum[0] == $idnum[2]){	$owner = 1;	$CurrLink = $_SESSION['tmpdir'];	$CurrLink2 = substr($_SESSION['tmpdir'],0,11) . ".tmp/";	if (($_GET['edit'] == 'ch') && ($_SESSION['edit_stat'] == 1))	$EditMode = 0;	elseif (($_GET['edit'] == 'ch') && ($_SESSION['edit_stat'] == 0))	$EditMode = 1;	elseif ($_GET['edit'] == 1) $EditMode = 1;		if (($_GET['edit'] == 'ch') && ($EditMode == 1))		$m = "edon";	elseif (($_GET['edit'] == 'ch') && ($EditMode == 0))	$m = "edof";}else{	$owner = 0;	$CurrLink2 = substr($_SESSION['tmpdir'],0,11) . ".tmp/";}$Img_Dir = "../tmp/img/" . $CurrLink;$Aud_Dir = "../tmp/aud/" . $CurrLink;$TbleGrp = GenerateTableGroup($idnum[2]);$ThemeColor = $_GET['th'];$TextColor = ColorOffset($ThemeColor,(-106));$OffColor = ColorOffset($ThemeColor,(-28));$BorderColor = ColorOffset($ThemeColor,(-92));$HiLiteColor = ColorOffset($ThemeColor,18);$query['PageInfo'] = "SELECT numcol, divline, prof_pic FROM pageinfo WHERE idnum = {$idnum[2]}";$PageInfo = @mysql_fetch_array(@mysql_query($query['PageInfo'],$connection));$PageWidth = 700;$ItmWidth = floor($PageWidth/$PageInfo['numcol']);$prfht = $_SESSION['prfht'] - round($ItmWidth/2);$query['LayoutInfo'] = "SELECT * FROM items WHERE idnum={$idnum[2]}";if ($LayoutInfo = @mysql_fetch_array(@mysql_query($query['LayoutInfo'],$connection))){	for ($ColNum = 0 ; $ColNum < $PageInfo['numcol'] ; $ColNum++)		{	for ($ItmRep = 0; $ItmRep <= 7; $ItmRep++)		{	$ColName = 'c' . $ColNum . 'i' . $ItmRep;			if ($LayoutInfo[$ColName] != 0)			{	$GetItemQuery = "SELECT type, file, ext FROM {$TbleGrp['uploads']} WHERE rank = {$LayoutInfo[$ColName]}" ;				if ($Item = @mysql_fetch_array(@mysql_query ($GetItemQuery, $connection)))				{	if ($Item['type'] == 'img')					{	$FileName =  $idnum[2] . "." . $Item['file'] . "." . $Item['ext'];						$col_item[$ColName] = MakeImageAnItem($FileName,"../tmp/img/{$CurrLink2}",$ItmWidth,$EditMode);					}					elseif ($Item['type'] == 'lst')					$col_item[$ColName] = AudioListItem($ItmWidth,$EditMode,$idnum[2],$Item['file'],substr($_SESSION['tmpdir'],0,11),$ThemeColor);										elseif ($Item['type'] == 'alb')					{	$query['GetAlbum'] = "SELECT itm1";						for ($i = 2; $i <= 50; $i++)	$query['GetAlbum'] .= ", itm{$i}";						$query['GetAlbum'] .= " FROM {$TbleGrp['lists']} WHERE rank={$Item['file']}";						$NumPhotos = 0;						if ($AlbumItms = @mysql_fetch_array(@mysql_query($query['GetAlbum'], $connection)))						{	for ($cntr = 1; $cntr <= 50; $cntr++)							{	$name = "itm" . $cntr;								if (!(empty($AlbumItms[$name])))	$NumPhotos++;								elseif ($AlbumItms[$name] == 0)		break;						}	}						$col_item[$ColName] =							ImageListItem($ItmWidth,$EditMode,$idnum[2],$Item['file'],substr($_SESSION['tmpdir'],0,11),$ThemeColor,$NumPhotos);					}					else	$col_item[$ColName] = "";			}	}					}			for($ItemNum=0; $ItemNum <= 7; $ItemNum++) 		{	$ColName = 'c' . $ColNum . 'i' . $ItemNum;			$ColNameNxt = 'c' . $ColNum . 'i' . ($ItemNum + 1);			if 	(empty($col_item[$ColNameNxt]))	$LastItm = 1;	else	$LastItm = 0;						if ((($LastItm == 1) || ($LastItm == 0)) && (!(empty($col_item[$ColName]))))			{	$col[$ColName] = "<tr><td>";				if ($PageInfo['divline'] != 0)	$col[$ColName] .=  "<hr width=\"{$PageInfo['divline']}%\">";				$col[$ColName] .= "<center>";				if ($EditMode == 1)				$col[$ColName] .= "<div style=\"display:table-row;\">"			. EditModeGen($sess_id,$idnum[0],$idnum[2],$ThemeColor,$key,$ColNum,$ItemNum,$ItmWidth,$PageInfo['numcol'],$LastItm)			. "</div>";				$col[$ColName] .= $col_item[$ColName] . '</center>';			$col[$ColName] .= '</td></tr>';			}		}		$column[$ColNum] = '<table style="'						.	'position:absolute;';//		if ($EditMode == 1) $column[$ColNum] .= "top:32px;";		$column[$ColNum] .= 'left:' . ((6*($ColNum))+($ItmWidth*$ColNum)) . 'px;'						.	'width:' . $ItmWidth . 'px;';		if ($ColNum == 0) $column[$ColNum] .= "top:{$prfht}px;";		else $column[$ColNum] .= "top:". (floor(($PageInfo['numcol']-$ColNum-1)*$ItmWidth/2)) ."px;";		$column[$ColNum] .= '"><tbody>';		for($ItemNum = 0; $ItemNum <= 7; $ItemNum++)		{	$ColName = 'c' . $ColNum . 'i' . $ItemNum;			$column[$ColNum] .= $col[$ColName];		}		$column[$ColNum] .= "</tbody></table>";	}	}if ($EditMode == 1)echo "<style>" . EditModeStyles($PageInfo['numcol']) . "</style>";$Func['ColNum'] = 'ChngColNum';$Func['DivLine'] = 'ChngDivLine';echo LoadFromDropDown('mainpage',$Func['ColNum']);echo LoadFromDropDown('mainpage',$Func['DivLine']);echo "</head><body";if (!(empty($m)))	echo " onLoad=\"top.console.location='../user/console.php?th={$ThemeColor}&key={$key}&m={$m}';\">";else						echo ">";/*if ($EditMode == 1){$ForwardInfo = "sess={$sess_id}&loc={$idnum[2]}&th={$ThemeColor}&key={$key}";$sc[$PageInfo['numcol']] = " (Set)";$sd[$PageInfo['divline']] = " (Set)";echo "<div style=\"position:absolute;left:2px;width:708px;height:22px;background-color:#{$ThemeColor};border:solid 2px #{$BorderColor};\">"."<form method=\"get\" name=\"{$Func['DivLine']}\" style=\"float:right;\">"."<select name=\"newPage\" onchange=\"Load{$Func['DivLine']}();\">"."<option value=\"\" selected=selected>Item Divide Lines</option>"."<option value=\"../editmode/change_divline.php?{$ForwardInfo}&div=0\">No Divide Lines{$sd[0]}</option>"."<option value=\"../editmode/change_divline.php?{$ForwardInfo}&div=50\">1/2 Width Lines{$sd[50]}</option>"."<option value=\"../editmode/change_divline.php?{$ForwardInfo}&div=100\">Full Width Lines{$sd[100]}</option>"."</select>"."</form>"."<form method=\"get\" name=\"{$Func['ColNum']}\" style=\"float:right;\">"."<select name=\"newPage\" onchange=\"Load{$Func['ColNum']}();\">"."<option value=\"\" selected=selected>Number of Columns</option>"."<option value=\"../editmode/change_colnum.php?{$ForwardInfo}&NumCol=2\">2 Columns{$sc[2]}</option>"."<option value=\"../editmode/change_colnum.php?{$ForwardInfo}&NumCol=3\">3 Columns{$sc[3]}</option>"."<option value=\"../editmode/change_colnum.php?{$ForwardInfo}&NumCol=4\">4 Columns{$sc[4]}</option>"."</select>"."</form>"."</div>";}*/$_SESSION['edit_stat'] = $EditMode;for ($rep = 0; $rep < $PageInfo['numcol']; $rep++)		echo $column[$rep];?></body></html>