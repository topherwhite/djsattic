<?php	require '../includes/mySQL_Sessions.inc';require '../includes/DirectoryRelated.inc';require '../includes/ValidateEmail.inc';$clean['lgnE'] = ereg_replace('\'', '`', $_POST['lgnE']);$clean['lgnP'] = ereg_replace('\'', '`', $_POST['lgnP']);if	(empty($clean["lgnP"])) {	$ForwardInfo = "status=nopswd&lgnE={$clean['lgnE']}";	header("Location: ../gen/home.php?{$ForwardInfo}");	exit;}elseif (($status = CheckEmail($clean["lgnE"])) != 'valid'){	$ForwardInfo = "status={$status}";	header("Location: ../gen/home.php?{$ForwardInfo}");	exit;}else{	if (!($connection = @mysql_connect($sqlserver,$sqlusername,$sqluserpswd)))	die("Could not connect to database");	if (!(mysql_select_db($databasename,$connection)))							showerror();		$email = mysqlclean($clean, "lgnE", 50, $connection);	$pswd = md5(mysqlclean($clean, "lgnP", 20, $connection));	$query['Lookup'] = "SELECT idnum FROM login WHERE email='{$email}' AND pswdMD5='{$pswd}'";	if (!($idnum = @mysql_fetch_array(@mysql_query($query['Lookup'],$connection))))	{	$query['CheckEmail'] = "SELECT rank FROM login WHERE email='{$email}'";		if (!($rank = @mysql_fetch_array(@mysql_query($query['CheckEmail'],$connection))))		{ header("Location: ../gen/home.php?status=bademail&lgnE={$clean['lgnE']}"); exit; }		else		{ header("Location: ../gen/home.php?status=badpass&lgnE={$clean['lgnE']}"); exit; }	}	else	{	header("Location: ../login/login_final.php?id={$idnum['idnum']}");	exit;	}}?>